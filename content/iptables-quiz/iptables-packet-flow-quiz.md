# IP Tables and Packet Flow - Quiz

Test your knowledge of iptables, packet flow, and Linux firewall concepts with this 10-question quiz organized by difficulty level.

---

## Level 1: Fundamentals (Easy)

### Question 1
**Which iptables table is primarily used for packet filtering (allow/deny)?**

A) nat
B) mangle
C) filter
D) raw

<details>
<summary>Answer</summary>

**C) filter**

The filter table is the default table used for packet filtering operations. It contains the INPUT, FORWARD, and OUTPUT chains and is used to make decisions about whether packets should be allowed or denied.
</details>

---

### Question 2
**In which chain does DNAT (Destination NAT) occur?**

A) INPUT
B) OUTPUT
C) PREROUTING
D) POSTROUTING

<details>
<summary>Answer</summary>

**C) PREROUTING**

DNAT happens in the PREROUTING chain before the routing decision is made. This is where port forwarding rules are applied to change the destination address/port of incoming packets.
</details>

---

### Question 3
**Which built-in chain processes packets destined for local processes?**

A) FORWARD
B) INPUT
C) OUTPUT
D) PREROUTING

<details>
<summary>Answer</summary>

**B) INPUT**

The INPUT chain processes packets that are destined for local processes on the system. After the routing decision determines the packet is for the local machine, it goes through the INPUT chain.
</details>

---

## Level 2: Intermediate (Moderate Difficulty)

### Question 4
**What is the correct order of chains for a packet arriving from the network and destined for a local process?**

A) PREROUTING → INPUT → Local Process
B) INPUT → PREROUTING → Local Process
C) PREROUTING → FORWARD → INPUT → Local Process
D) RAW → PREROUTING → FORWARD → Local Process

<details>
<summary>Answer</summary>

**A) PREROUTING → INPUT → Local Process**

When a packet arrives from the network and is destined for a local process, it first goes through PREROUTING (where DNAT can occur), then a routing decision is made, and then it enters the INPUT chain before reaching the local process.
</details>

---

### Question 5
**Which iptables command enables masquerading for outgoing traffic on interface eth0?**

A) `iptables -t filter -A OUTPUT -o eth0 -j MASQUERADE`
B) `iptables -t nat -A PREROUTING -i eth0 -j MASQUERADE`
C) `iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE`
D) `iptables -t mangle -A POSTROUTING -o eth0 -j MASQUERADE`

<details>
<summary>Answer</summary>

**C) `iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE`**

Masquerading (a form of SNAT) happens in the POSTROUTING chain of the nat table, after the routing decision. The `-o eth0` specifies the outgoing interface.
</details>

---

### Question 6
**A packet generated by a local application needs to reach an external server. Which chains does it traverse?**

A) OUTPUT → POSTROUTING
B) INPUT → OUTPUT → POSTROUTING
C) OUTPUT → FORWARD → POSTROUTING
D) PREROUTING → OUTPUT → POSTROUTING

<details>
<summary>Answer</summary>

**A) OUTPUT → POSTROUTING**

Packets generated by local processes go through the OUTPUT chain first (in the filter table), then through POSTROUTING (where SNAT/masquerading can occur) before leaving the network interface.
</details>

---

### Question 7
**Which table would you use to modify packet TTL (Time To Live) values?**

A) filter
B) nat
C) mangle
D) raw

<details>
<summary>Answer</summary>

**C) mangle**

The mangle table is used for packet modification, including changing TTL, ToS (Type of Service), and other packet headers. It's available in all chains.
</details>

---

## Level 3: Advanced (High Difficulty)

### Question 8
**You want to forward external port 8080 to internal server 192.168.1.20:80. Which two rules are required?**

A) DNAT in PREROUTING and ACCEPT in INPUT
B) DNAT in POSTROUTING and ACCEPT in FORWARD
C) DNAT in PREROUTING and ACCEPT in FORWARD
D) SNAT in PREROUTING and ACCEPT in OUTPUT

<details>
<summary>Answer</summary>

**C) DNAT in PREROUTING and ACCEPT in FORWARD**

Port forwarding requires two rules:
1. A DNAT rule in the PREROUTING chain to change the destination: `iptables -t nat -A PREROUTING -p tcp --dport 8080 -j DNAT --to-destination 192.168.1.20:80`
2. An ACCEPT rule in the FORWARD chain to allow the forwarded packets: `iptables -A FORWARD -p tcp -d 192.168.1.20 --dport 80 -j ACCEPT`

The packet is being routed to a different host, so it goes through FORWARD, not INPUT.
</details>

---

### Question 9
**Consider this conntrack entry:**
```
tcp 6 299 ESTABLISHED src=192.168.1.10 dst=142.250.190.46 sport=51100 dport=443 \
    src=142.250.190.46 dst=100.72.5.12 sport=443 dport=30001 [ASSURED]
```
**What does this indicate about the connection?**

A) The connection is still in SYN-SENT state
B) NAT is being performed, changing the source port from 51100 to 30001
C) The connection is established and packets have been seen in both directions
D) The connection is about to time out in 6 seconds

<details>
<summary>Answer</summary>

**B) NAT is being performed, changing the source port from 51100 to 30001**

The conntrack entry shows two direction tuples. The first shows the original packet (src=192.168.1.10:51100 → dst=142.250.190.46:443), and the second shows the return path. The return destination is 100.72.5.12:30001, indicating NAT is translating the source address and port. The [ASSURED] flag means packets have been seen in both directions, making option C also true, but the most significant detail is the NAT operation shown by the different addresses/ports.
</details>

---

### Question 10
**A packet arrives on eth0 from 10.0.0.5:5000 destined for 192.168.1.100:80. The system has IP forwarding enabled and routes the packet to eth1. Through which tables and chains does this packet traverse IN ORDER?**

A) raw(PREROUTING) → nat(PREROUTING) → filter(FORWARD) → nat(POSTROUTING)
B) raw(INPUT) → filter(INPUT) → filter(OUTPUT) → nat(POSTROUTING)
C) raw(PREROUTING) → nat(PREROUTING) → filter(INPUT) → filter(OUTPUT)
D) nat(PREROUTING) → filter(INPUT) → filter(FORWARD) → mangle(POSTROUTING)

<details>
<summary>Answer</summary>

**A) raw(PREROUTING) → nat(PREROUTING) → filter(FORWARD) → nat(POSTROUTING)**

For a forwarded packet:
1. **raw(PREROUTING)**: First table in PREROUTING for connection tracking exemptions
2. **nat(PREROUTING)**: DNAT happens here if needed
3. **Routing decision**: Determines packet needs forwarding
4. **mangle(FORWARD)**: Packet modification (not listed in option but occurs)
5. **filter(FORWARD)**: Firewall filtering for forwarded packets
6. **mangle(POSTROUTING)**: Additional packet modification (not listed)
7. **nat(POSTROUTING)**: SNAT/Masquerading happens here

Option A is the most accurate, though it simplifies by omitting mangle chains. The packet never touches INPUT or OUTPUT chains since it's being forwarded, not processed locally.
</details>

---

## Scoring Guide

- **0-3 correct**: Review the basics of iptables tables and chains
- **4-6 correct**: Good foundation, practice packet flow scenarios
- **7-8 correct**: Strong understanding, focus on advanced NAT concepts
- **9-10 correct**: Excellent! You have mastery of iptables and packet flow

---

## Additional Resources

- View your current iptables rules: `iptables -L -n -v`
- View NAT table: `iptables -t nat -L -n -v`
- View connection tracking: `conntrack -L`
- Test your understanding by drawing packet flow diagrams for different scenarios
